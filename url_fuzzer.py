import urllib.request
import time 

# File of dir listings
path = "dirb.txt"
txt_file = open(path, "r")

# User input for site
site = input("Site for testing: ") 

# Wait time between pings
wait = float(input("Wait time pings (seconds): "))

for line in txt_file:

    # Remove truncation
    item = line.strip()
    # item = line.replace(" ", "")
    
    # URL for targeting 
    url = "https://tryhackme.com/" + item + "/"

    try:
        # Attempting request
        req = urllib.request.Request(url=url)
        response = urllib.request.urlopen(req)
        status_code = response.getcode()
        
        # Current Response
        print(f"{url} {status_code}")

        # Waiting a second to not break the server
        time.sleep(wait)

        # Write URL to txt file if found
        with open('dir_list.txt', 'a') as file:
            file.write(url + " " + str(status_code))
            file.write("\n")

    # Pass if error response
    except OSError:
        print("ERROR " + url)
        pass
        time.sleep(wait)

